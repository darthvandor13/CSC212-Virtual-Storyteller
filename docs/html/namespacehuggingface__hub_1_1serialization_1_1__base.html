<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: huggingface_hub.serialization._base Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacehuggingface__hub.html">huggingface_hub</a></li><li class="navelem"><a class="el" href="namespacehuggingface__hub_1_1serialization.html">serialization</a></li><li class="navelem"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html">_base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">huggingface_hub.serialization._base Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classhuggingface__hub_1_1serialization_1_1__base_1_1StateDictSplit.html">StateDictSplit</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0bb21a58b3fea28d2688bc334351f1c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classhuggingface__hub_1_1serialization_1_1__base_1_1StateDictSplit.html">StateDictSplit</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a0bb21a58b3fea28d2688bc334351f1c1">split_state_dict_into_shards_factory</a> (Dict[str, <a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a>] state_dict, *<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#aae8cf7da01a9aca3825adff32faa9d3b">TensorSizeFn_T</a> get_storage_size, str filename_pattern, <a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a1f3f29d5851cea9cf3734b10bb6f9ee6">StorageIDFn_T</a> get_storage_id=lambda tensor:None, Union[int, str] max_shard_size=<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a517a337c1d405561adefcc47b5351bd3">MAX_SHARD_SIZE</a>)</td></tr>
<tr class="separator:a0bb21a58b3fea28d2688bc334351f1c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2638bda2933955031f831c4dd70bcb44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a2638bda2933955031f831c4dd70bcb44">parse_size_to_int</a> (str size_as_str)</td></tr>
<tr class="separator:a2638bda2933955031f831c4dd70bcb44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a72cce05abd958ac086fc881e92e7ae58"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a> = TypeVar(&quot;TensorT&quot;)</td></tr>
<tr class="separator:a72cce05abd958ac086fc881e92e7ae58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae8cf7da01a9aca3825adff32faa9d3b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#aae8cf7da01a9aca3825adff32faa9d3b">TensorSizeFn_T</a> = Callable[[<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a>], int]</td></tr>
<tr class="separator:aae8cf7da01a9aca3825adff32faa9d3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f3f29d5851cea9cf3734b10bb6f9ee6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a1f3f29d5851cea9cf3734b10bb6f9ee6">StorageIDFn_T</a> = Callable[[<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a>], Optional[Any]]</td></tr>
<tr class="separator:a1f3f29d5851cea9cf3734b10bb6f9ee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a517a337c1d405561adefcc47b5351bd3"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a517a337c1d405561adefcc47b5351bd3">MAX_SHARD_SIZE</a> = &quot;5GB&quot;</td></tr>
<tr class="separator:a517a337c1d405561adefcc47b5351bd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad185e18d12efc1c600dfaa45ac1a457b"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#ad185e18d12efc1c600dfaa45ac1a457b">SIZE_UNITS</a></td></tr>
<tr class="separator:ad185e18d12efc1c600dfaa45ac1a457b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6903facfe9120c14fc34d7fa3014eed8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a6903facfe9120c14fc34d7fa3014eed8">logger</a> = logging.get_logger(__file__)</td></tr>
<tr class="separator:a6903facfe9120c14fc34d7fa3014eed8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2638bda2933955031f831c4dd70bcb44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2638bda2933955031f831c4dd70bcb44">&#9670;&nbsp;</a></span>parse_size_to_int()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int huggingface_hub.serialization._base.parse_size_to_int </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>size_as_str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parse a size expressed as a string with digits and unit (like `"5MB"`) to an integer (in bytes).

Supported units are "TB", "GB", "MB", "KB".

Args:
    size_as_str (`str`): The size to convert. Will be directly returned if an `int`.

Example:

```py
&gt;&gt;&gt; parse_size_to_int("5MB")
5000000
```
</pre> 
</div>
</div>
<a id="a0bb21a58b3fea28d2688bc334351f1c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb21a58b3fea28d2688bc334351f1c1">&#9670;&nbsp;</a></span>split_state_dict_into_shards_factory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classhuggingface__hub_1_1serialization_1_1__base_1_1StateDictSplit.html">StateDictSplit</a> huggingface_hub.serialization._base.split_state_dict_into_shards_factory </td>
          <td>(</td>
          <td class="paramtype">Dict[str, <a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a>]&#160;</td>
          <td class="paramname"><em>state_dict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#aae8cf7da01a9aca3825adff32faa9d3b">TensorSizeFn_T</a>&#160;</td>
          <td class="paramname"><em>get_storage_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>filename_pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a1f3f29d5851cea9cf3734b10bb6f9ee6">StorageIDFn_T</a> &#160;</td>
          <td class="paramname"><em>get_storage_id</em> = <code>lambda&#160;tensor:&#160;None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Union[int, str] &#160;</td>
          <td class="paramname"><em>max_shard_size</em> = <code><a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a517a337c1d405561adefcc47b5351bd3">MAX_SHARD_SIZE</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Split a model state dictionary in shards so that each shard is smaller than a given size.

The shards are determined by iterating through the `state_dict` in the order of its keys. There is no optimization
made to make each shard as close as possible to the maximum size passed. For example, if the limit is 10GB and we
have tensors of sizes [6GB, 6GB, 2GB, 6GB, 2GB, 2GB] they will get sharded as [6GB], [6+2GB], [6+2+2GB] and not
[6+2+2GB], [6+2GB], [6GB].

&lt;Tip warning={true}&gt;

If one of the model's tensor is bigger than `max_shard_size`, it will end up in its own shard which will have a
size greater than `max_shard_size`.

&lt;/Tip&gt;

Args:
    state_dict (`Dict[str, Tensor]`):
        The state dictionary to save.
    get_storage_size (`Callable[[Tensor], int]`):
        A function that returns the size of a tensor when saved on disk in bytes.
    get_storage_id (`Callable[[Tensor], Optional[Any]]`, *optional*):
        A function that returns a unique identifier to a tensor storage. Multiple different tensors can share the
        same underlying storage. This identifier is guaranteed to be unique and constant for this tensor's storage
        during its lifetime. Two tensor storages with non-overlapping lifetimes may have the same id.
    filename_pattern (`str`, *optional*):
        The pattern to generate the files names in which the model will be saved. Pattern must be a string that
        can be formatted with `filename_pattern.format(suffix=...)` and must contain the keyword `suffix`
    max_shard_size (`int` or `str`, *optional*):
        The maximum size of each shard, in bytes. Defaults to 5GB.

Returns:
    [`StateDictSplit`]: A `StateDictSplit` object containing the shards and the index to retrieve them.
</pre> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6903facfe9120c14fc34d7fa3014eed8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6903facfe9120c14fc34d7fa3014eed8">&#9670;&nbsp;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">huggingface_hub.serialization._base.logger = logging.get_logger(__file__)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a517a337c1d405561adefcc47b5351bd3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a517a337c1d405561adefcc47b5351bd3">&#9670;&nbsp;</a></span>MAX_SHARD_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string huggingface_hub.serialization._base.MAX_SHARD_SIZE = &quot;5GB&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad185e18d12efc1c600dfaa45ac1a457b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad185e18d12efc1c600dfaa45ac1a457b">&#9670;&nbsp;</a></span>SIZE_UNITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dictionary huggingface_hub.serialization._base.SIZE_UNITS</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;=  {</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    <span class="stringliteral">&quot;TB&quot;</span>: 10**12,</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    <span class="stringliteral">&quot;GB&quot;</span>: 10**9,</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    <span class="stringliteral">&quot;MB&quot;</span>: 10**6,</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    <span class="stringliteral">&quot;KB&quot;</span>: 10**3,</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f3f29d5851cea9cf3734b10bb6f9ee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f3f29d5851cea9cf3734b10bb6f9ee6">&#9670;&nbsp;</a></span>StorageIDFn_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">huggingface_hub.serialization._base.StorageIDFn_T = Callable[[<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a>], Optional[Any]]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aae8cf7da01a9aca3825adff32faa9d3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae8cf7da01a9aca3825adff32faa9d3b">&#9670;&nbsp;</a></span>TensorSizeFn_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">huggingface_hub.serialization._base.TensorSizeFn_T = Callable[[<a class="el" href="namespacehuggingface__hub_1_1serialization_1_1__base.html#a72cce05abd958ac086fc881e92e7ae58">TensorT</a>], int]</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a72cce05abd958ac086fc881e92e7ae58"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72cce05abd958ac086fc881e92e7ae58">&#9670;&nbsp;</a></span>TensorT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">huggingface_hub.serialization._base.TensorT = TypeVar(&quot;TensorT&quot;)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
