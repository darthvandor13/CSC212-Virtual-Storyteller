<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: onnxruntime.tools.reduced_build_config_parser Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceonnxruntime.html">onnxruntime</a></li><li class="navelem"><a class="el" href="namespaceonnxruntime_1_1tools.html">tools</a></li><li class="navelem"><a class="el" href="namespaceonnxruntime_1_1tools_1_1reduced__build__config__parser.html">reduced_build_config_parser</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">onnxruntime.tools.reduced_build_config_parser Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a142ba654b055be7a7e8b2504c77734ba"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceonnxruntime_1_1tools_1_1reduced__build__config__parser.html#a142ba654b055be7a7e8b2504c77734ba">parse_config</a> (str config_file, bool enable_type_reduction=False)</td></tr>
<tr class="separator:a142ba654b055be7a7e8b2504c77734ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a940bfda361e4f88a8dac017d7415aed3"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceonnxruntime_1_1tools_1_1reduced__build__config__parser.html#a940bfda361e4f88a8dac017d7415aed3">have_flatbuffers</a> = True</td></tr>
<tr class="separator:a940bfda361e4f88a8dac017d7415aed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a142ba654b055be7a7e8b2504c77734ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a142ba654b055be7a7e8b2504c77734ba">&#9670;&nbsp;</a></span>parse_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def onnxruntime.tools.reduced_build_config_parser.parse_config </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>config_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>enable_type_reduction</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Parse the configuration file and return the required operators dictionary and an
OpTypeImplFilterInterface instance.

Configuration file lines can do the following:
1. specify required operators
2. specify globally allowed types for all operators
3. specify what it means for no required operators to be specified

1. Specifying required operators

The basic format for specifying required operators is `domain;opset1,opset2;op1,op2...`
e.g. `ai.onnx;11;Add,Cast,Clip,... for a single opset
     `ai.onnx;11,12;Add,Cast,Clip,... for multiple opsets

     note: Configuration information is accrued as the file is parsed. If an operator requires support from multiple
     opsets that can be done with one entry for each opset, or one entry with multiple opsets in it.

If the configuration file is generated from ORT format models it may optionally contain JSON for per-operator
type reduction. The required types are generally listed per input and/or output of the operator.
The type information is in a map, with 'inputs' and 'outputs' keys. The value for 'inputs' or 'outputs' is a map
between the index number of the input/output and the required list of types.

For example, both the input and output types are relevant to ai.onnx:Cast.
Type information for input 0 and output 0 could look like this:
    `{"inputs": {"0": ["float", "int32_t"]}, "outputs": {"0": ["float", "int64_t"]}}`

which is added directly after the operator name in the configuration file.
e.g.
    `ai.onnx;12;Add,Cast{"inputs": {"0": ["float", "int32_t"]}, "outputs": {"0": ["float", "int64_t"]}},Concat`

If for example the types of inputs 0 and 1 were important, the entry may look like this (e.g. ai.onnx:Gather):
    `{"inputs": {"0": ["float", "int32_t"], "1": ["int32_t"]}}`

Finally some operators do non-standard things and store their type information under a 'custom' key.
ai.onnx.OneHot is an example of this, where the three input types are combined into a triple.
    `{"custom": [["float", "int64_t", "int64_t"], ["int64_t", "std::string", "int64_t"]]}`

2. Specifying globally allowed types for all operators

The format for specifying globally allowed types for all operators is:
    `!globally_allowed_types;T0,T1,...`

Ti should be a C++ scalar type supported by ONNX and ORT.
At most one globally allowed types specification is allowed.

Specifying per-operator type information and specifying globally allowed types are mutually exclusive - it is an
error to specify both.

3. Specify what it means for no required operators to be specified

By default, if no required operators are specified, NO operators are required.

With the following line, if no required operators are specified, ALL operators are required:
    `!no_ops_specified_means_all_ops_are_required`

:param config_file: Configuration file to parse
:param enable_type_reduction: Set to True to use the type information in the config.
                              If False the type information will be ignored.
                              If the flatbuffers module is unavailable type information will be ignored as the
                              type-based filtering has a dependency on the ORT flatbuffers schema.
:return: required_ops: Dictionary of domain:opset:[ops] for required operators. If None, all operators are
                       required.
         op_type_impl_filter: OpTypeImplFilterInterface instance if type reduction is enabled, the flatbuffers
                              module is available, and type reduction information is present. None otherwise.
</pre> 
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a940bfda361e4f88a8dac017d7415aed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a940bfda361e4f88a8dac017d7415aed3">&#9670;&nbsp;</a></span>have_flatbuffers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool onnxruntime.tools.reduced_build_config_parser.have_flatbuffers = True</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
