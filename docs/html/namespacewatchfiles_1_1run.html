<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: watchfiles.run Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacewatchfiles.html">watchfiles</a></li><li class="navelem"><a class="el" href="namespacewatchfiles_1_1run.html">run</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">watchfiles.run Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classwatchfiles_1_1run_1_1CombinedProcess.html">CombinedProcess</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a92b8e89caed19f6c667e970e39ec0862"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a92b8e89caed19f6c667e970e39ec0862">run_process</a> (*Union[Path, str] paths, Union[str, Callable[..., Any]] target, Tuple[Any,...] args=(), Optional[Dict[str, Any]] kwargs=None, &quot;Literal['function', 'command', 'auto']&quot; target_type='auto', Optional[Callable[[Set[FileChange]], None]] callback=None, Optional[Callable[[<a class="el" href="classwatchfiles_1_1main_1_1Change.html">Change</a>, str], bool]] watch_filter=<a class="el" href="classwatchfiles_1_1filters_1_1DefaultFilter.html">DefaultFilter</a>(), float grace_period=0, int debounce=1_600, int step=50, Optional[bool] debug=None, int sigint_timeout=5, int sigkill_timeout=1, bool recursive=True, bool ignore_permission_denied=False)</td></tr>
<tr class="separator:a92b8e89caed19f6c667e970e39ec0862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b5777447f07c35d545aa3ff1abe3b9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a3b5777447f07c35d545aa3ff1abe3b9d">arun_process</a> (*Union[Path, str] paths, Union[str, Callable[..., Any]] target, Tuple[Any,...] args=(), Optional[Dict[str, Any]] kwargs=None, &quot;Literal['function', 'command', 'auto']&quot; target_type='auto', Optional[Callable[[Set[FileChange]], Any]] callback=None, Optional[Callable[[<a class="el" href="classwatchfiles_1_1main_1_1Change.html">Change</a>, str], bool]] watch_filter=<a class="el" href="classwatchfiles_1_1filters_1_1DefaultFilter.html">DefaultFilter</a>(), float grace_period=0, int debounce=1_600, int step=50, Optional[bool] debug=None, bool recursive=True, bool ignore_permission_denied=False)</td></tr>
<tr class="separator:a3b5777447f07c35d545aa3ff1abe3b9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40298f14780dd7bc6035577ea7a57cc8"><td class="memItemLeft" align="right" valign="top">List[str]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a40298f14780dd7bc6035577ea7a57cc8">split_cmd</a> (str cmd)</td></tr>
<tr class="separator:a40298f14780dd7bc6035577ea7a57cc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2eff76422e88d27b88ec453913a3a7d"><td class="memItemLeft" align="right" valign="top"> '<a class="el" href="classwatchfiles_1_1run_1_1CombinedProcess.html">CombinedProcess</a>'&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#ac2eff76422e88d27b88ec453913a3a7d">start_process</a> (Union[str, Callable[..., Any]] target, &quot;Literal['function', 'command']&quot; target_type, Tuple[Any,...] args, Optional[Dict[str, Any]] kwargs, Optional[Set[FileChange]] changes=None)</td></tr>
<tr class="separator:ac2eff76422e88d27b88ec453913a3a7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd8cd0ebe6971be6714d56b45e277aa"><td class="memItemLeft" align="right" valign="top">&quot;Literal['function', 'command']&quot;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#affd8cd0ebe6971be6714d56b45e277aa">detect_target_type</a> (Union[str, Callable[..., Any]] target)</td></tr>
<tr class="separator:affd8cd0ebe6971be6714d56b45e277aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6fcb5a1c81b036b5979062c7df30806"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#ad6fcb5a1c81b036b5979062c7df30806">run_function</a> (str function, Optional[str] tty_path, Tuple[Any,...] args, Dict[str, Any] kwargs)</td></tr>
<tr class="separator:ad6fcb5a1c81b036b5979062c7df30806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840392bf85f0a0d3077c8562cfd335dc"><td class="memItemLeft" align="right" valign="top">Any&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a840392bf85f0a0d3077c8562cfd335dc">import_string</a> (str dotted_path)</td></tr>
<tr class="separator:a840392bf85f0a0d3077c8562cfd335dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89c943369c4e51b0a3a1c18998aed62d"><td class="memItemLeft" align="right" valign="top">Optional[str]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a89c943369c4e51b0a3a1c18998aed62d">get_tty_path</a> ()</td></tr>
<tr class="separator:a89c943369c4e51b0a3a1c18998aed62d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09305dfced177487579bca6c10dcd70a"><td class="memItemLeft" align="right" valign="top">Generator[None, None, None]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a09305dfced177487579bca6c10dcd70a">set_tty</a> (Optional[str] tty_path)</td></tr>
<tr class="separator:a09305dfced177487579bca6c10dcd70a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b8883f77282bc3fe721d53fc69094ea"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a1b8883f77282bc3fe721d53fc69094ea">raise_keyboard_interrupt</a> (int signum, Any _frame)</td></tr>
<tr class="separator:a1b8883f77282bc3fe721d53fc69094ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03887fb9b388020c5ca273cc08145957"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a03887fb9b388020c5ca273cc08145957">catch_sigterm</a> ()</td></tr>
<tr class="separator:a03887fb9b388020c5ca273cc08145957"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0466d2308eff4c47b97860974f67a3bf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#a0466d2308eff4c47b97860974f67a3bf">logger</a> = logging.getLogger('watchfiles.main')</td></tr>
<tr class="separator:a0466d2308eff4c47b97860974f67a3bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd10b63067a17e453b2f950420fad8c9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacewatchfiles_1_1run.html#afd10b63067a17e453b2f950420fad8c9">spawn_context</a> = get_context('spawn')</td></tr>
<tr class="separator:afd10b63067a17e453b2f950420fad8c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3b5777447f07c35d545aa3ff1abe3b9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b5777447f07c35d545aa3ff1abe3b9d">&#9670;&nbsp;</a></span>arun_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int watchfiles.run.arun_process </td>
          <td>(</td>
          <td class="paramtype">*Union[Path, str]&#160;</td>
          <td class="paramname"><em>paths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Union[str, Callable[..., Any]]&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tuple[Any, ...] &#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Dict[str, Any]] &#160;</td>
          <td class="paramname"><em>kwargs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Literal['function', 'command', 'auto']&quot; &#160;</td>
          <td class="paramname"><em>target_type</em> = <code>'auto'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Callable[[Set[FileChange]], Any]] &#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Callable[[<a class="el" href="classwatchfiles_1_1main_1_1Change.html">Change</a>, str], bool]] &#160;</td>
          <td class="paramname"><em>watch_filter</em> = <code><a class="el" href="classwatchfiles_1_1filters_1_1DefaultFilter.html">DefaultFilter</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>grace_period</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>debounce</em> = <code>1_600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>step</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[bool] &#160;</td>
          <td class="paramname"><em>debug</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>recursive</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>ignore_permission_denied</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Async equivalent of [`run_process`][watchfiles.run_process], all arguments match those of `run_process` except
`callback` which can be a coroutine.

Starting and stopping the process and watching for changes is done in a separate thread.

As with `run_process`, internally `arun_process` uses [`awatch`][watchfiles.awatch], however `KeyboardInterrupt`
cannot be caught and suppressed in `awatch` so these errors need to be caught separately, see below.

```py title="Example of arun_process usage"
import asyncio
from watchfiles import arun_process

async def callback(changes):
    await asyncio.sleep(0.1)
    print('changes detected:', changes)

def foobar(a, b):
    print('foobar called with:', a, b)

async def main():
    await arun_process('.', target=foobar, args=(1, 2), callback=callback)

if __name__ == '__main__':
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        print('stopped via KeyboardInterrupt')
```
</pre> 
</div>
</div>
<a id="a03887fb9b388020c5ca273cc08145957"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03887fb9b388020c5ca273cc08145957">&#9670;&nbsp;</a></span>catch_sigterm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">None watchfiles.run.catch_sigterm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Catch SIGTERM and raise KeyboardInterrupt instead. This means watchfiles will stop quickly
on `docker compose stop` and other cases where SIGTERM is sent.

Without this the watchfiles process will be killed while a running process will continue uninterrupted.
</pre> 
</div>
</div>
<a id="affd8cd0ebe6971be6714d56b45e277aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affd8cd0ebe6971be6714d56b45e277aa">&#9670;&nbsp;</a></span>detect_target_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> &quot;Literal['function', 'command']&quot; watchfiles.run.detect_target_type </td>
          <td>(</td>
          <td class="paramtype">Union[str, Callable[..., Any]]&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Used by [`run_process`][watchfiles.run_process], [`arun_process`][watchfiles.arun_process]
and indirectly the CLI to determine the target type with `target_type` is `auto`.

Detects the target type - either `function` or `command`. This method is only called with `target_type='auto'`.

The following logic is employed:

* If `target` is not a string, it is assumed to be a function
* If `target` ends with `.py` or `.sh`, it is assumed to be a command
* Otherwise, the target is assumed to be a function if it matches the regex `[a-zA-Z0-9_]+(\\.[a-zA-Z0-9_]+)+`

If this logic does not work for you, specify the target type explicitly using the `target_type` function argument
or `--target-type` command line argument.

Args:
    target: The target value

Returns:
    either `'function'` or `'command'`
</pre> 
</div>
</div>
<a id="a89c943369c4e51b0a3a1c18998aed62d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c943369c4e51b0a3a1c18998aed62d">&#9670;&nbsp;</a></span>get_tty_path()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Optional[str] watchfiles.run.get_tty_path </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return the path to the current TTY, if any.

Virtually impossible to test in pytest, hence no cover.
</pre> 
</div>
</div>
<a id="a840392bf85f0a0d3077c8562cfd335dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840392bf85f0a0d3077c8562cfd335dc">&#9670;&nbsp;</a></span>import_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Any watchfiles.run.import_string </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>dotted_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Stolen approximately from django. Import a dotted module path and return the attribute/class designated by the
last name in the path. Raise ImportError if the import fails.
</pre> 
</div>
</div>
<a id="a1b8883f77282bc3fe721d53fc69094ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b8883f77282bc3fe721d53fc69094ea">&#9670;&nbsp;</a></span>raise_keyboard_interrupt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">None watchfiles.run.raise_keyboard_interrupt </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>signum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Any&#160;</td>
          <td class="paramname"><em>_frame</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad6fcb5a1c81b036b5979062c7df30806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6fcb5a1c81b036b5979062c7df30806">&#9670;&nbsp;</a></span>run_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">None watchfiles.run.run_function </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[str]&#160;</td>
          <td class="paramname"><em>tty_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tuple[Any, ...]&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a92b8e89caed19f6c667e970e39ec0862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92b8e89caed19f6c667e970e39ec0862">&#9670;&nbsp;</a></span>run_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> int watchfiles.run.run_process </td>
          <td>(</td>
          <td class="paramtype">*Union[Path, str]&#160;</td>
          <td class="paramname"><em>paths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Union[str, Callable[..., Any]]&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tuple[Any, ...] &#160;</td>
          <td class="paramname"><em>args</em> = <code>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Dict[str, Any]] &#160;</td>
          <td class="paramname"><em>kwargs</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Literal['function', 'command', 'auto']&quot; &#160;</td>
          <td class="paramname"><em>target_type</em> = <code>'auto'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Callable[[Set[FileChange]], None]] &#160;</td>
          <td class="paramname"><em>callback</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Callable[[<a class="el" href="classwatchfiles_1_1main_1_1Change.html">Change</a>, str], bool]] &#160;</td>
          <td class="paramname"><em>watch_filter</em> = <code><a class="el" href="classwatchfiles_1_1filters_1_1DefaultFilter.html">DefaultFilter</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>grace_period</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>debounce</em> = <code>1_600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>step</em> = <code>50</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[bool] &#160;</td>
          <td class="paramname"><em>debug</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>sigint_timeout</em> = <code>5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>sigkill_timeout</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>recursive</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &#160;</td>
          <td class="paramname"><em>ignore_permission_denied</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Run a process and restart it upon file changes.

`run_process` can work in two ways:

* Using `multiprocessing.Process` † to run a python function
* Or, using `subprocess.Popen` to run a command

!!! note

    **†** technically `multiprocessing.get_context('spawn').Process` to avoid forking and improve
    code reload/import.

Internally, `run_process` uses [`watch`][watchfiles.watch] with `raise_interrupt=False` so the function
exits cleanly upon `Ctrl+C`.

Args:
    *paths: matches the same argument of [`watch`][watchfiles.watch]
    target: function or command to run
    args: arguments to pass to `target`, only used if `target` is a function
    kwargs: keyword arguments to pass to `target`, only used if `target` is a function
    target_type: type of target. Can be `'function'`, `'command'`, or `'auto'` in which case
        [`detect_target_type`][watchfiles.run.detect_target_type] is used to determine the type.
    callback: function to call on each reload, the function should accept a set of changes as the sole argument
    watch_filter: matches the same argument of [`watch`][watchfiles.watch]
    grace_period: number of seconds after the process is started before watching for changes
    debounce: matches the same argument of [`watch`][watchfiles.watch]
    step: matches the same argument of [`watch`][watchfiles.watch]
    debug: matches the same argument of [`watch`][watchfiles.watch]
    sigint_timeout: the number of seconds to wait after sending sigint before sending sigkill
    sigkill_timeout: the number of seconds to wait after sending sigkill before raising an exception
    recursive: matches the same argument of [`watch`][watchfiles.watch]

Returns:
    number of times the function was reloaded.

```py title="Example of run_process running a function"
from watchfiles import run_process

def callback(changes):
    print('changes detected:', changes)

def foobar(a, b):
    print('foobar called with:', a, b)

if __name__ == '__main__':
    run_process('./path/to/dir', target=foobar, args=(1, 2), callback=callback)
```

As well as using a `callback` function, changes can be accessed from within the target function,
using the `WATCHFILES_CHANGES` environment variable.

```py title="Example of run_process accessing changes"
from watchfiles import run_process

def foobar(a, b, c):
    # changes will be an empty list "[]" the first time the function is called
    changes = os.getenv('WATCHFILES_CHANGES')
    changes = json.loads(changes)
    print('foobar called due to changes:', changes)

if __name__ == '__main__':
    run_process('./path/to/dir', target=foobar, args=(1, 2, 3))
```

Again with the target as `command`, `WATCHFILES_CHANGES` can be used
to access changes.

```bash title="example.sh"
echo "changers: ${WATCHFILES_CHANGES}"
```

```py title="Example of run_process running a command"
from watchfiles import run_process

if __name__ == '__main__':
    run_process('.', target='./example.sh')
```
</pre> 
</div>
</div>
<a id="a09305dfced177487579bca6c10dcd70a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09305dfced177487579bca6c10dcd70a">&#9670;&nbsp;</a></span>set_tty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Generator[None, None, None] watchfiles.run.set_tty </td>
          <td>(</td>
          <td class="paramtype">Optional[str]&#160;</td>
          <td class="paramname"><em>tty_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a40298f14780dd7bc6035577ea7a57cc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40298f14780dd7bc6035577ea7a57cc8">&#9670;&nbsp;</a></span>split_cmd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> List[str] watchfiles.run.split_cmd </td>
          <td>(</td>
          <td class="paramtype">str&#160;</td>
          <td class="paramname"><em>cmd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac2eff76422e88d27b88ec453913a3a7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2eff76422e88d27b88ec453913a3a7d">&#9670;&nbsp;</a></span>start_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classwatchfiles_1_1run_1_1CombinedProcess.html">CombinedProcess</a> watchfiles.run.start_process </td>
          <td>(</td>
          <td class="paramtype">Union[str, Callable[..., Any]]&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Literal['function', 'command']&quot;&#160;</td>
          <td class="paramname"><em>target_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tuple[Any, ...]&#160;</td>
          <td class="paramname"><em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Dict[str, Any]]&#160;</td>
          <td class="paramname"><em>kwargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[Set[FileChange]] &#160;</td>
          <td class="paramname"><em>changes</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0466d2308eff4c47b97860974f67a3bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0466d2308eff4c47b97860974f67a3bf">&#9670;&nbsp;</a></span>logger</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">watchfiles.run.logger = logging.getLogger('watchfiles.main')</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afd10b63067a17e453b2f950420fad8c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd10b63067a17e453b2f950420fad8c9">&#9670;&nbsp;</a></span>spawn_context</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">watchfiles.run.spawn_context = get_context('spawn')</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
