<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: sqlalchemy.engine.interfaces.CreateEnginePlugin Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesqlalchemy.html">sqlalchemy</a></li><li class="navelem"><a class="el" href="namespacesqlalchemy_1_1engine.html">engine</a></li><li class="navelem"><a class="el" href="namespacesqlalchemy_1_1engine_1_1interfaces.html">interfaces</a></li><li class="navelem"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html">CreateEnginePlugin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">sqlalchemy.engine.interfaces.CreateEnginePlugin Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a6d660fcf89bece4fe9b7c43fb1c3fce0"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#a6d660fcf89bece4fe9b7c43fb1c3fce0">__init__</a> (self, <a class="el" href="classsqlalchemy_1_1engine_1_1url_1_1URL.html">URL</a> <a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#abad7aba289fd6c4367869ec4e28e6454">url</a>, Dict[str, Any] kwargs)</td></tr>
<tr class="separator:a6d660fcf89bece4fe9b7c43fb1c3fce0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af81928895aded8912f73b1c500a1f3b5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classsqlalchemy_1_1engine_1_1url_1_1URL.html">URL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#af81928895aded8912f73b1c500a1f3b5">update_url</a> (self, <a class="el" href="classsqlalchemy_1_1engine_1_1url_1_1URL.html">URL</a> <a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#abad7aba289fd6c4367869ec4e28e6454">url</a>)</td></tr>
<tr class="separator:af81928895aded8912f73b1c500a1f3b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a2e4a6fe217657f3817425a1feb2b22"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#a2a2e4a6fe217657f3817425a1feb2b22">handle_dialect_kwargs</a> (self, Type[<a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1Dialect.html">Dialect</a>] dialect_cls, Dict[str, Any] dialect_args)</td></tr>
<tr class="separator:a2a2e4a6fe217657f3817425a1feb2b22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3673c8a4810461fb160c46187841665b"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#a3673c8a4810461fb160c46187841665b">handle_pool_kwargs</a> (self, Type[Pool] pool_cls, Dict[str, Any] pool_args)</td></tr>
<tr class="separator:a3673c8a4810461fb160c46187841665b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf68fb2c11b1456ac0eb379cebc13ca5"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#abf68fb2c11b1456ac0eb379cebc13ca5">engine_created</a> (self, <a class="el" href="classsqlalchemy_1_1engine_1_1base_1_1Engine.html">Engine</a> engine)</td></tr>
<tr class="separator:abf68fb2c11b1456ac0eb379cebc13ca5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:abad7aba289fd6c4367869ec4e28e6454"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1CreateEnginePlugin.html#abad7aba289fd6c4367869ec4e28e6454">url</a></td></tr>
<tr class="separator:abad7aba289fd6c4367869ec4e28e6454"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">A set of hooks intended to augment the construction of an
:class:`_engine.Engine` object based on entrypoint names in a URL.

The purpose of :class:`_engine.CreateEnginePlugin` is to allow third-party
systems to apply engine, pool and dialect level event listeners without
the need for the target application to be modified; instead, the plugin
names can be added to the database URL.  Target applications for
:class:`_engine.CreateEnginePlugin` include:

* connection and SQL performance tools, e.g. which use events to track
  number of checkouts and/or time spent with statements

* connectivity plugins such as proxies

A rudimentary :class:`_engine.CreateEnginePlugin` that attaches a logger
to an :class:`_engine.Engine` object might look like::


    import logging

    from sqlalchemy.engine import CreateEnginePlugin
    from sqlalchemy import event


    class LogCursorEventsPlugin(CreateEnginePlugin):
        def __init__(self, url, kwargs):
            # consume the parameter "log_cursor_logging_name" from the
            # URL query
            logging_name = url.query.get(
                "log_cursor_logging_name", "log_cursor"
            )

            self.log = logging.getLogger(logging_name)

        def update_url(self, url):
            "update the URL to one that no longer includes our parameters"
            return url.difference_update_query(["log_cursor_logging_name"])

        def engine_created(self, engine):
            "attach an event listener after the new Engine is constructed"
            event.listen(engine, "before_cursor_execute", self._log_event)

        def _log_event(
            self,
            conn,
            cursor,
            statement,
            parameters,
            context,
            executemany,
        ):

            self.log.info("Plugin logged cursor event: %s", statement)

Plugins are registered using entry points in a similar way as that
of dialects::

    entry_points = {
        "sqlalchemy.plugins": [
            "log_cursor_plugin = myapp.plugins:LogCursorEventsPlugin"
        ]
    }

A plugin that uses the above names would be invoked from a database
URL as in::

    from sqlalchemy import create_engine

    engine = create_engine(
        "mysql+pymysql://scott:tiger@localhost/test?"
        "plugin=log_cursor_plugin&amp;log_cursor_logging_name=mylogger"
    )

The ``plugin`` URL parameter supports multiple instances, so that a URL
may specify multiple plugins; they are loaded in the order stated
in the URL::

    engine = create_engine(
        "mysql+pymysql://scott:tiger@localhost/test?"
        "plugin=plugin_one&amp;plugin=plugin_twp&amp;plugin=plugin_three"
    )

The plugin names may also be passed directly to :func:`_sa.create_engine`
using the :paramref:`_sa.create_engine.plugins` argument::

    engine = create_engine(
        "mysql+pymysql://scott:tiger@localhost/test", plugins=["myplugin"]
    )

.. versionadded:: 1.2.3  plugin names can also be specified
   to :func:`_sa.create_engine` as a list

A plugin may consume plugin-specific arguments from the
:class:`_engine.URL` object as well as the ``kwargs`` dictionary, which is
the dictionary of arguments passed to the :func:`_sa.create_engine`
call.  "Consuming" these arguments includes that they must be removed
when the plugin initializes, so that the arguments are not passed along
to the :class:`_engine.Dialect` constructor, where they will raise an
:class:`_exc.ArgumentError` because they are not known by the dialect.

As of version 1.4 of SQLAlchemy, arguments should continue to be consumed
from the ``kwargs`` dictionary directly, by removing the values with a
method such as ``dict.pop``. Arguments from the :class:`_engine.URL` object
should be consumed by implementing the
:meth:`_engine.CreateEnginePlugin.update_url` method, returning a new copy
of the :class:`_engine.URL` with plugin-specific parameters removed::

    class MyPlugin(CreateEnginePlugin):
        def __init__(self, url, kwargs):
            self.my_argument_one = url.query["my_argument_one"]
            self.my_argument_two = url.query["my_argument_two"]
            self.my_argument_three = kwargs.pop("my_argument_three", None)

        def update_url(self, url):
            return url.difference_update_query(
                ["my_argument_one", "my_argument_two"]
            )

Arguments like those illustrated above would be consumed from a
:func:`_sa.create_engine` call such as::

    from sqlalchemy import create_engine

    engine = create_engine(
        "mysql+pymysql://scott:tiger@localhost/test?"
        "plugin=myplugin&amp;my_argument_one=foo&amp;my_argument_two=bar",
        my_argument_three="bat",
    )

.. versionchanged:: 1.4

    The :class:`_engine.URL` object is now immutable; a
    :class:`_engine.CreateEnginePlugin` that needs to alter the
    :class:`_engine.URL` should implement the newly added
    :meth:`_engine.CreateEnginePlugin.update_url` method, which
    is invoked after the plugin is constructed.

    For migration, construct the plugin in the following way, checking
    for the existence of the :meth:`_engine.CreateEnginePlugin.update_url`
    method to detect which version is running::

        class MyPlugin(CreateEnginePlugin):
            def __init__(self, url, kwargs):
                if hasattr(CreateEnginePlugin, "update_url"):
                    # detect the 1.4 API
                    self.my_argument_one = url.query["my_argument_one"]
                    self.my_argument_two = url.query["my_argument_two"]
                else:
                    # detect the 1.3 and earlier API - mutate the
                    # URL directly
                    self.my_argument_one = url.query.pop("my_argument_one")
                    self.my_argument_two = url.query.pop("my_argument_two")

                self.my_argument_three = kwargs.pop("my_argument_three", None)

            def update_url(self, url):
                # this method is only called in the 1.4 version
                return url.difference_update_query(
                    ["my_argument_one", "my_argument_two"]
                )

    .. seealso::

        :ref:`change_5526` - overview of the :class:`_engine.URL` change which
        also includes notes regarding :class:`_engine.CreateEnginePlugin`.


When the engine creation process completes and produces the
:class:`_engine.Engine` object, it is again passed to the plugin via the
:meth:`_engine.CreateEnginePlugin.engine_created` hook.  In this hook, additional
changes can be made to the engine, most typically involving setup of
events (e.g. those defined in :ref:`core_event_toplevel`).</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a6d660fcf89bece4fe9b7c43fb1c3fce0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d660fcf89bece4fe9b7c43fb1c3fce0">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def sqlalchemy.engine.interfaces.CreateEnginePlugin.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsqlalchemy_1_1engine_1_1url_1_1URL.html">URL</a>&#160;</td>
          <td class="paramname"><em>url</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Dict[str, Any]&#160;</td>
          <td class="paramname"><em>kwargs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a new :class:`.CreateEnginePlugin`.

The plugin object is instantiated individually for each call
to :func:`_sa.create_engine`.  A single :class:`_engine.
Engine` will be
passed to the :meth:`.CreateEnginePlugin.engine_created` method
corresponding to this URL.

:param url: the :class:`_engine.URL` object.  The plugin may inspect
 the :class:`_engine.URL` for arguments.  Arguments used by the
 plugin should be removed, by returning an updated :class:`_engine.URL`
 from the :meth:`_engine.CreateEnginePlugin.update_url` method.

 .. versionchanged::  1.4

    The :class:`_engine.URL` object is now immutable, so a
    :class:`_engine.CreateEnginePlugin` that needs to alter the
    :class:`_engine.URL` object should implement the
    :meth:`_engine.CreateEnginePlugin.update_url` method.

:param kwargs: The keyword arguments passed to
 :func:`_sa.create_engine`.</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="abf68fb2c11b1456ac0eb379cebc13ca5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf68fb2c11b1456ac0eb379cebc13ca5">&#9670;&nbsp;</a></span>engine_created()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None sqlalchemy.engine.interfaces.CreateEnginePlugin.engine_created </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsqlalchemy_1_1engine_1_1base_1_1Engine.html">Engine</a>&#160;</td>
          <td class="paramname"><em>engine</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Receive the :class:`_engine.Engine`
object when it is fully constructed.

The plugin may make additional changes to the engine, such as
registering engine or connection pool events.</pre> 
</div>
</div>
<a id="a2a2e4a6fe217657f3817425a1feb2b22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a2e4a6fe217657f3817425a1feb2b22">&#9670;&nbsp;</a></span>handle_dialect_kwargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None sqlalchemy.engine.interfaces.CreateEnginePlugin.handle_dialect_kwargs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Type[<a class="el" href="classsqlalchemy_1_1engine_1_1interfaces_1_1Dialect.html">Dialect</a>]&#160;</td>
          <td class="paramname"><em>dialect_cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Dict[str, Any]
    &#160;</td>
          <td class="paramname"><em>dialect_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">parse and modify dialect kwargs</pre> 
</div>
</div>
<a id="a3673c8a4810461fb160c46187841665b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3673c8a4810461fb160c46187841665b">&#9670;&nbsp;</a></span>handle_pool_kwargs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None sqlalchemy.engine.interfaces.CreateEnginePlugin.handle_pool_kwargs </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Type[Pool]&#160;</td>
          <td class="paramname"><em>pool_cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Dict[str, Any]
    &#160;</td>
          <td class="paramname"><em>pool_args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">parse and modify pool kwargs</pre> 
</div>
</div>
<a id="af81928895aded8912f73b1c500a1f3b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af81928895aded8912f73b1c500a1f3b5">&#9670;&nbsp;</a></span>update_url()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> <a class="el" href="classsqlalchemy_1_1engine_1_1url_1_1URL.html">URL</a> sqlalchemy.engine.interfaces.CreateEnginePlugin.update_url </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsqlalchemy_1_1engine_1_1url_1_1URL.html">URL</a>&#160;</td>
          <td class="paramname"><em>url</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Update the :class:`_engine.URL`.

A new :class:`_engine.URL` should be returned.   This method is
typically used to consume configuration arguments from the
:class:`_engine.URL` which must be removed, as they will not be
recognized by the dialect.  The
:meth:`_engine.URL.difference_update_query` method is available
to remove these arguments.   See the docstring at
:class:`_engine.CreateEnginePlugin` for an example.


.. versionadded:: 1.4</pre> 
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="abad7aba289fd6c4367869ec4e28e6454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abad7aba289fd6c4367869ec4e28e6454">&#9670;&nbsp;</a></span>url</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">sqlalchemy.engine.interfaces.CreateEnginePlugin.url</td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct a new :class:`.CreateEnginePlugin`.

The plugin object is instantiated individually for each call
to :func:`_sa.create_engine`.  A single :class:`_engine.
Engine` will be
passed to the :meth:`.CreateEnginePlugin.engine_created` method
corresponding to this URL.

:param url: the :class:`_engine.URL` object.  The plugin may inspect
 the :class:`_engine.URL` for arguments.  Arguments used by the
 plugin should be removed, by returning an updated :class:`_engine.URL`
 from the :meth:`_engine.CreateEnginePlugin.update_url` method.

 .. versionchanged::  1.4

    The :class:`_engine.URL` object is now immutable, so a
    :class:`_engine.CreateEnginePlugin` that needs to alter the
    :class:`_engine.URL` object should implement the
    :meth:`_engine.CreateEnginePlugin.update_url` method.

:param kwargs: The keyword arguments passed to
 :func:`_sa.create_engine`.</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>py3_env/lib/python3.10/site-packages/sqlalchemy/engine/<a class="el" href="py3__env_2lib_2python3_810_2site-packages_2sqlalchemy_2engine_2interfaces_8py.html">interfaces.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
