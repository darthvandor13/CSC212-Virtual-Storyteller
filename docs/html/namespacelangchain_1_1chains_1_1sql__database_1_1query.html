<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: langchain.chains.sql_database.query Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelangchain.html">langchain</a></li><li class="navelem"><a class="el" href="namespacelangchain_1_1chains.html">chains</a></li><li class="navelem"><a class="el" href="namespacelangchain_1_1chains_1_1sql__database.html">sql_database</a></li><li class="navelem"><a class="el" href="namespacelangchain_1_1chains_1_1sql__database_1_1query.html">query</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">langchain.chains.sql_database.query Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain_1_1chains_1_1sql__database_1_1query_1_1SQLInput.html">SQLInput</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain_1_1chains_1_1sql__database_1_1query_1_1SQLInputWithTables.html">SQLInputWithTables</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae4b5a3e28835676a036b6a24f4097ceb"><td class="memItemLeft" align="right" valign="top">Runnable[Union[<a class="el" href="classlangchain_1_1chains_1_1sql__database_1_1query_1_1SQLInput.html">SQLInput</a>, <a class="el" href="classlangchain_1_1chains_1_1sql__database_1_1query_1_1SQLInputWithTables.html">SQLInputWithTables</a>, Dict[str, Any]], str]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacelangchain_1_1chains_1_1sql__database_1_1query.html#ae4b5a3e28835676a036b6a24f4097ceb">create_sql_query_chain</a> (BaseLanguageModel llm, SQLDatabase db, Optional[BasePromptTemplate] prompt=None, int k=5)</td></tr>
<tr class="separator:ae4b5a3e28835676a036b6a24f4097ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ae4b5a3e28835676a036b6a24f4097ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b5a3e28835676a036b6a24f4097ceb">&#9670;&nbsp;</a></span>create_sql_query_chain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> Runnable[Union[<a class="el" href="classlangchain_1_1chains_1_1sql__database_1_1query_1_1SQLInput.html">SQLInput</a>, <a class="el" href="classlangchain_1_1chains_1_1sql__database_1_1query_1_1SQLInputWithTables.html">SQLInputWithTables</a>, Dict[str, Any]], str] langchain.chains.sql_database.query.create_sql_query_chain </td>
          <td>(</td>
          <td class="paramtype">BaseLanguageModel&#160;</td>
          <td class="paramname"><em>llm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SQLDatabase&#160;</td>
          <td class="paramname"><em>db</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Optional[BasePromptTemplate] &#160;</td>
          <td class="paramname"><em>prompt</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &#160;</td>
          <td class="paramname"><em>k</em> = <code>5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a chain that generates SQL queries.

*Security Note*: This chain generates SQL queries for the given database.

    The SQLDatabase class provides a get_table_info method that can be used
    to get column information as well as sample data from the table.

    To mitigate risk of leaking sensitive data, limit permissions
    to read and scope to the tables that are needed.

    Optionally, use the SQLInputWithTables input type to specify which tables
    are allowed to be accessed.

    Control access to who can submit requests to this chain.

    See https://python.langchain.com/docs/security for more information.

Args:
    llm: The language model to use.
    db: The SQLDatabase to generate the query for.
    prompt: The prompt to use. If none is provided, will choose one
        based on dialect. Defaults to None. See Prompt section below for more.
    k: The number of results per select statement to return. Defaults to 5.

Returns:
    A chain that takes in a question and generates a SQL query that answers
    that question.

Example:

    .. code-block:: python

        # pip install -U langchain langchain-community langchain-openai
        from langchain_openai import ChatOpenAI
        from langchain.chains import create_sql_query_chain
        from langchain_community.utilities import SQLDatabase

        db = SQLDatabase.from_uri("sqlite:///Chinook.db")
        llm = ChatOpenAI(model="gpt-3.5-turbo", temperature=0)
        chain = create_sql_query_chain(llm, db)
        response = chain.invoke({"question": "How many employees are there"})

Prompt:
    If no prompt is provided, a default prompt is selected based on the SQLDatabase dialect. If one is provided, it must support input variables:
        * input: The user question plus suffix "\nSQLQuery: " is passed here.
        * top_k: The number of results per select statement (the `k` argument to
            this function) is passed in here.
        * table_info: Table definitions and sample rows are passed in here. If the
            user specifies "table_names_to_use" when invoking chain, only those
            will be included. Otherwise, all tables are included.
        * dialect (optional): If dialect input variable is in prompt, the db
            dialect will be passed in here.

    Here's an example prompt:

    .. code-block:: python

        from langchain_core.prompts import PromptTemplate

        template = '''Given an input question, first create a syntactically correct {dialect} query to run, then look at the results of the query and return the answer.
        Use the following format:

        Question: "Question here"
        SQLQuery: "SQL Query to run"
        SQLResult: "Result of the SQLQuery"
        Answer: "Final answer here"

        Only use the following tables:

        {table_info}.

        Question: {input}'''
        prompt = PromptTemplate.from_template(template)
</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
