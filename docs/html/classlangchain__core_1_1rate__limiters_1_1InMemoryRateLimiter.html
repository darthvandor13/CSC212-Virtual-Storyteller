<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: langchain_core.rate_limiters.InMemoryRateLimiter Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacelangchain__core.html">langchain_core</a></li><li class="navelem"><a class="el" href="namespacelangchain__core_1_1rate__limiters.html">rate_limiters</a></li><li class="navelem"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html">InMemoryRateLimiter</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">langchain_core.rate_limiters.InMemoryRateLimiter Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for langchain_core.rate_limiters.InMemoryRateLimiter:</div>
<div class="dyncontent">
<div class="center"><img src="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter__inherit__graph.png" border="0" usemap="#alangchain__core_8rate__limiters_8InMemoryRateLimiter_inherit__map" alt="Inheritance graph"/></div>
<!-- MAP 0 -->
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for langchain_core.rate_limiters.InMemoryRateLimiter:</div>
<div class="dyncontent">
<div class="center"><img src="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter__coll__graph.png" border="0" usemap="#alangchain__core_8rate__limiters_8InMemoryRateLimiter_coll__map" alt="Collaboration graph"/></div>
<!-- MAP 1 -->
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a16cd0fb835e6b6d88713539bc9fa27df"><td class="memItemLeft" align="right" valign="top">None&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a16cd0fb835e6b6d88713539bc9fa27df">__init__</a> (self, *float <a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a2d9db832c2e81507fd0c4812fd0b512e">requests_per_second</a>=1, float <a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a003408ad07baf41f47ab95b64b5d070f">check_every_n_seconds</a>=0.1, float <a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#aa32b83e9aa4ed7e37b7404f792c65ef2">max_bucket_size</a>=1)</td></tr>
<tr class="separator:a16cd0fb835e6b6d88713539bc9fa27df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a224b234c8d5602c5c93f631a21488375"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a224b234c8d5602c5c93f631a21488375">acquire</a> (self, *bool blocking=True)</td></tr>
<tr class="separator:a224b234c8d5602c5c93f631a21488375"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe1e7e5b701ecf282374a6b34d9b8b8b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#afe1e7e5b701ecf282374a6b34d9b8b8b">aacquire</a> (self, *bool blocking=True)</td></tr>
<tr class="separator:afe1e7e5b701ecf282374a6b34d9b8b8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a2d9db832c2e81507fd0c4812fd0b512e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a2d9db832c2e81507fd0c4812fd0b512e">requests_per_second</a></td></tr>
<tr class="separator:a2d9db832c2e81507fd0c4812fd0b512e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aceb7422520f398989ccf8f2fd8047afa"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#aceb7422520f398989ccf8f2fd8047afa">available_tokens</a></td></tr>
<tr class="separator:aceb7422520f398989ccf8f2fd8047afa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa32b83e9aa4ed7e37b7404f792c65ef2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#aa32b83e9aa4ed7e37b7404f792c65ef2">max_bucket_size</a></td></tr>
<tr class="separator:aa32b83e9aa4ed7e37b7404f792c65ef2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a003408ad07baf41f47ab95b64b5d070f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a003408ad07baf41f47ab95b64b5d070f">check_every_n_seconds</a></td></tr>
<tr class="separator:a003408ad07baf41f47ab95b64b5d070f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a877a178f154bde78acb0dfd375d9536d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classlangchain__core_1_1rate__limiters_1_1InMemoryRateLimiter.html#a877a178f154bde78acb0dfd375d9536d">last</a></td></tr>
<tr class="separator:a877a178f154bde78acb0dfd375d9536d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">An in memory rate limiter based on a token bucket algorithm.

This is an in memory rate limiter, so it cannot rate limit across
different processes.

The rate limiter only allows time-based rate limiting and does not
take into account any information about the input or the output, so it
cannot be used to rate limit based on the size of the request.

It is thread safe and can be used in either a sync or async context.

The in memory rate limiter is based on a token bucket. The bucket is filled
with tokens at a given rate. Each request consumes a token. If there are
not enough tokens in the bucket, the request is blocked until there are
enough tokens.

These *tokens* have NOTHING to do with LLM tokens. They are just
a way to keep track of how many requests can be made at a given time.

Current limitations:

- The rate limiter is not designed to work across different processes. It is
  an in-memory rate limiter, but it is thread safe.
- The rate limiter only supports time-based rate limiting. It does not take
  into account the size of the request or any other factors.

Example:

    .. code-block:: python

        import time

        from langchain_core.rate_limiters import InMemoryRateLimiter

        rate_limiter = InMemoryRateLimiter(
            requests_per_second=0.1,  # &lt;-- Can only make a request once every 10 seconds!!
            check_every_n_seconds=0.1,  # Wake up every 100 ms to check whether allowed to make a request,
            max_bucket_size=10,  # Controls the maximum burst size.
        )

        from langchain_anthropic import ChatAnthropic
        model = ChatAnthropic(
            model_name="claude-3-opus-20240229",
            rate_limiter=rate_limiter
        )

        for _ in range(5):
            tic = time.time()
            model.invoke("hello")
            toc = time.time()
            print(toc - tic)


.. versionadded:: 0.2.24
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a16cd0fb835e6b6d88713539bc9fa27df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16cd0fb835e6b6d88713539bc9fa27df">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> None langchain_core.rate_limiters.InMemoryRateLimiter.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*float &#160;</td>
          <td class="paramname"><em>requests_per_second</em> = <code>1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>check_every_n_seconds</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float &#160;</td>
          <td class="paramname"><em>max_bucket_size</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">An in memory rate limiter based on a token bucket algorithm.

This is an in memory rate limiter, so it cannot rate limit across
different processes.

The rate limiter only allows time-based rate limiting and does not
take into account any information about the input or the output, so it
cannot be used to rate limit based on the size of the request.

It is thread safe and can be used in either a sync or async context.

The in memory rate limiter is based on a token bucket. The bucket is filled
with tokens at a given rate. Each request consumes a token. If there are
not enough tokens in the bucket, the request is blocked until there are
enough tokens.

These *tokens* have NOTHING to do with LLM tokens. They are just
a way to keep track of how many requests can be made at a given time.

Current limitations:

- The rate limiter is not designed to work across different processes. It is
  an in-memory rate limiter, but it is thread safe.
- The rate limiter only supports time-based rate limiting. It does not take
  into account the size of the request or any other factors.

Example:

    .. code-block:: python

        import time

        from langchain_core.rate_limiters import InMemoryRateLimiter

        rate_limiter = InMemoryRateLimiter(
            requests_per_second=0.1,  # &lt;-- Can only make a request once every 10 seconds!!
            check_every_n_seconds=0.1,  # Wake up every 100 ms to check whether allowed to make a request,
            max_bucket_size=10,  # Controls the maximum burst size.
        )

        from langchain_anthropic import ChatAnthropic
        model = ChatAnthropic(
            model_name="claude-3-opus-20240229",
            rate_limiter=rate_limiter
        )

        for _ in range(5):
            tic = time.time()
            model.invoke("hello")
            toc = time.time()
            print(toc - tic)


.. versionadded:: 0.2.24
</pre><pre class="fragment">A rate limiter based on a token bucket.

These *tokens* have NOTHING to do with LLM tokens. They are just
a way to keep track of how many requests can be made at a given time.

This rate limiter is designed to work in a threaded environment.

It works by filling up a bucket with tokens at a given rate. Each
request consumes a given number of tokens. If there are not enough
tokens in the bucket, the request is blocked until there are enough
tokens.

Args:
    requests_per_second: The number of tokens to add per second to the bucket.
        Must be at least 1. The tokens represent "credit" that can be used
        to make requests.
    check_every_n_seconds: check whether the tokens are available
        every this many seconds. Can be a float to represent
        fractions of a second.
    max_bucket_size: The maximum number of tokens that can be in the bucket.
        This is used to prevent bursts of requests.
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="afe1e7e5b701ecf282374a6b34d9b8b8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe1e7e5b701ecf282374a6b34d9b8b8b">&#9670;&nbsp;</a></span>aacquire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool langchain_core.rate_limiters.InMemoryRateLimiter.aacquire </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*bool &#160;</td>
          <td class="paramname"><em>blocking</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Attempt to acquire a token from the rate limiter. Async version.

This method blocks until the required tokens are available if `blocking`
is set to True.

If `blocking` is set to False, the method will immediately return the result
of the attempt to acquire the tokens.

Args:
    blocking: If True, the method will block until the tokens are available.
        If False, the method will return immediately with the result of
        the attempt. Defaults to True.

Returns:
   True if the tokens were successfully acquired, False otherwise.
</pre> 
<p>Reimplemented from <a class="el" href="classlangchain__core_1_1rate__limiters_1_1BaseRateLimiter.html#a8c0d27facd8d22405da0b5121f95b38f">langchain_core.rate_limiters.BaseRateLimiter</a>.</p>

</div>
</div>
<a id="a224b234c8d5602c5c93f631a21488375"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a224b234c8d5602c5c93f631a21488375">&#9670;&nbsp;</a></span>acquire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"> bool langchain_core.rate_limiters.InMemoryRateLimiter.acquire </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">*bool &#160;</td>
          <td class="paramname"><em>blocking</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Attempt to acquire a token from the rate limiter.

This method blocks until the required tokens are available if `blocking`
is set to True.

If `blocking` is set to False, the method will immediately return the result
of the attempt to acquire the tokens.

Args:
    blocking: If True, the method will block until the tokens are available.
        If False, the method will return immediately with the result of
        the attempt. Defaults to True.

Returns:
   True if the tokens were successfully acquired, False otherwise.
</pre> 
<p>Reimplemented from <a class="el" href="classlangchain__core_1_1rate__limiters_1_1BaseRateLimiter.html#a70e3eccc8fc200dd385b01f2b11790d9">langchain_core.rate_limiters.BaseRateLimiter</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aceb7422520f398989ccf8f2fd8047afa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aceb7422520f398989ccf8f2fd8047afa">&#9670;&nbsp;</a></span>available_tokens</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">langchain_core.rate_limiters.InMemoryRateLimiter.available_tokens</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a003408ad07baf41f47ab95b64b5d070f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a003408ad07baf41f47ab95b64b5d070f">&#9670;&nbsp;</a></span>check_every_n_seconds</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">langchain_core.rate_limiters.InMemoryRateLimiter.check_every_n_seconds</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a877a178f154bde78acb0dfd375d9536d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a877a178f154bde78acb0dfd375d9536d">&#9670;&nbsp;</a></span>last</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">langchain_core.rate_limiters.InMemoryRateLimiter.last</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa32b83e9aa4ed7e37b7404f792c65ef2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa32b83e9aa4ed7e37b7404f792c65ef2">&#9670;&nbsp;</a></span>max_bucket_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">langchain_core.rate_limiters.InMemoryRateLimiter.max_bucket_size</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2d9db832c2e81507fd0c4812fd0b512e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d9db832c2e81507fd0c4812fd0b512e">&#9670;&nbsp;</a></span>requests_per_second</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">langchain_core.rate_limiters.InMemoryRateLimiter.requests_per_second</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>py3_env/lib/python3.10/site-packages/langchain_core/<a class="el" href="rate__limiters_8py.html">rate_limiters.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
