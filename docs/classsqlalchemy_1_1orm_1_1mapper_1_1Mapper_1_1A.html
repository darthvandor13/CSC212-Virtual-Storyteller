<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NAO Virtual Storyteller: sqlalchemy.orm.mapper.Mapper.A Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NAO Virtual Storyteller
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacesqlalchemy.html">sqlalchemy</a></li><li class="navelem"><a class="el" href="namespacesqlalchemy_1_1orm.html">orm</a></li><li class="navelem"><a class="el" href="namespacesqlalchemy_1_1orm_1_1mapper.html">mapper</a></li><li class="navelem"><a class="el" href="classsqlalchemy_1_1orm_1_1mapper_1_1Mapper.html">Mapper</a></li><li class="navelem"><a class="el" href="classsqlalchemy_1_1orm_1_1mapper_1_1Mapper_1_1A.html">A</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sqlalchemy.orm.mapper.Mapper.A Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for sqlalchemy.orm.mapper.Mapper.A:</div>
<div class="dyncontent">
<div class="center"><img src="classsqlalchemy_1_1orm_1_1mapper_1_1Mapper_1_1A__inherit__graph.png" border="0" usemap="#asqlalchemy_8orm_8mapper_8Mapper_8A_inherit__map" alt="Inheritance graph"/></div>
<!-- MAP 0 -->
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">pk_cols: Sequence[ColumnClause[Any]] = self.primary_key
if adapter:
    pk_cols = [adapter.columns[c] for c in pk_cols]

mapping: RowMapping
if hasattr(row, "_mapping"):
    mapping = row._mapping
else:
    mapping = row  # type: ignore[assignment]

return (
    self._identity_class,
    tuple(mapping[column] for column in pk_cols),
    identity_token,
)

def identity_key_from_primary_key(
self,
primary_key: Tuple[Any, ...],
identity_token: Optional[Any] = None,
) -&gt; _IdentityKeyType[_O]:
</pre><pre class="fragment">return (
    self._identity_class,
    tuple(primary_key),
    identity_token,
)

def identity_key_from_instance(self, instance: _O) -&gt; _IdentityKeyType[_O]:
</pre><pre class="fragment">state = attributes.instance_state(instance)
identity_key = self._identity_key_from_state(
    state, PassiveFlag.PASSIVE_OFF
)
return identity_key[1]

@HasMemoized.memoized_attribute
def _persistent_sortkey_fn(self):
key_fns = [col.type.sort_key_function for col in self.primary_key]

if set(key_fns).difference([None]):

    def key(state):
        return tuple(
            key_fn(val) if key_fn is not None else val
            for key_fn, val in zip(key_fns, state.key[1])
        )

else:

    def key(state):
        return state.key[1]

return key

@HasMemoized.memoized_attribute
def _identity_key_props(self):
return [self._columntoproperty[col] for col in self.primary_key]

@HasMemoized.memoized_attribute
def _all_pk_cols(self):
collection: Set[ColumnClause[Any]] = set()
for table in self.tables:
    collection.update(self._pks_by_table[table])
return collection

@HasMemoized.memoized_attribute
def _should_undefer_in_wildcard(self):
cols: Set[ColumnElement[Any]] = set(self.primary_key)
if self.polymorphic_on is not None:
    cols.add(self.polymorphic_on)
return cols

@HasMemoized.memoized_attribute
def _primary_key_propkeys(self):
return {self._columntoproperty[col].key for col in self._all_pk_cols}

def _get_state_attr_by_column(
self,
state: InstanceState[_O],
dict_: _InstanceDict,
column: ColumnElement[Any],
passive: PassiveFlag = PassiveFlag.PASSIVE_RETURN_NO_VALUE,
) -&gt; Any:
prop = self._columntoproperty[column]
return state.manager[prop.key].impl.get(state, dict_, passive=passive)

def _set_committed_state_attr_by_column(self, state, dict_, column, value):
prop = self._columntoproperty[column]
state.manager[prop.key].impl.set_committed_value(state, dict_, value)

def _set_state_attr_by_column(self, state, dict_, column, value):
prop = self._columntoproperty[column]
state.manager[prop.key].impl.set(state, dict_, value, None)

def _get_committed_attr_by_column(self, obj, column):
state = attributes.instance_state(obj)
dict_ = attributes.instance_dict(obj)
return self._get_committed_state_attr_by_column(
    state, dict_, column, passive=PassiveFlag.PASSIVE_OFF
)

def _get_committed_state_attr_by_column(
self, state, dict_, column, passive=PassiveFlag.PASSIVE_RETURN_NO_VALUE
):
prop = self._columntoproperty[column]
return state.manager[prop.key].impl.get_committed_value(
    state, dict_, passive=passive
)

def _optimized_get_statement(self, state, attribute_names):
</pre><pre class="fragment">props = self._props

col_attribute_names = set(attribute_names).intersection(
    state.mapper.column_attrs.keys()
)
tables: Set[FromClause] = set(
    chain(
        *[
            sql_util.find_tables(c, check_columns=True)
            for key in col_attribute_names
            for c in props[key].columns
        ]
    )
)

if self.base_mapper.local_table in tables:
    return None

def visit_binary(binary):
    leftcol = binary.left
    rightcol = binary.right
    if leftcol is None or rightcol is None:
        return

    if leftcol.table not in tables:
        leftval = self._get_committed_state_attr_by_column(
            state,
            state.dict,
            leftcol,
            passive=PassiveFlag.PASSIVE_NO_INITIALIZE,
        )
        if leftval in orm_util._none_set:
            raise _OptGetColumnsNotAvailable()
        binary.left = sql.bindparam(
            None, leftval, type_=binary.right.type
        )
    elif rightcol.table not in tables:
        rightval = self._get_committed_state_attr_by_column(
            state,
            state.dict,
            rightcol,
            passive=PassiveFlag.PASSIVE_NO_INITIALIZE,
        )
        if rightval in orm_util._none_set:
            raise _OptGetColumnsNotAvailable()
        binary.right = sql.bindparam(
            None, rightval, type_=binary.right.type
        )

allconds: List[ColumnElement[bool]] = []

start = False

# as of #7507, from the lowest base table on upwards,
# we include all intermediary tables.

for mapper in reversed(list(self.iterate_to_root())):
    if mapper.local_table in tables:
        start = True
    elif not isinstance(mapper.local_table, expression.TableClause):
        return None
    if start and not mapper.single:
        assert mapper.inherits
        assert not mapper.concrete
        assert mapper.inherit_condition is not None
        allconds.append(mapper.inherit_condition)
        tables.add(mapper.local_table)

# only the bottom table needs its criteria to be altered to fit
# the primary key ident - the rest of the tables upwards to the
# descendant-most class should all be present and joined to each
# other.
try:
    _traversed = visitors.cloned_traverse(
        allconds[0], {}, {"binary": visit_binary}
    )
except _OptGetColumnsNotAvailable:
    return None
else:
    allconds[0] = _traversed

cond = sql.and_(*allconds)

cols = []
for key in col_attribute_names:
    cols.extend(props[key].columns)
return (
    sql.select(*cols)
    .where(cond)
    .set_label_style(LABEL_STYLE_TABLENAME_PLUS_COL)
)

def _iterate_to_target_viawpoly(self, mapper):
if self.isa(mapper):
    prev = self
    for m in self.iterate_to_root():
        yield m

        if m is not prev and prev not in m._with_polymorphic_mappers:
            break

        prev = m
        if m is mapper:
            break

@HasMemoized.memoized_attribute
def _would_selectinload_combinations_cache(self):
return {}

def _would_selectin_load_only_from_given_mapper(self, super_mapper):
</pre> </div><hr/>The documentation for this class was generated from the following file:<ul>
<li>py3_env/lib/python3.10/site-packages/sqlalchemy/orm/<a class="el" href="mapper_8py.html">mapper.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
